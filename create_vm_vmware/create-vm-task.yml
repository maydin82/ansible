- name: Create a VM
  vmware.vmware_rest.vcenter_vm:
    placement:
      cluster: "{{ my_cluster_info.id }}"
      datastore: "{{ my_datastore.datastore }}"
      folder: "{{ my_virtual_machine_folder.folder }}"
    name: test_vm1
    guest_OS: RHEL_8_64
    cpu:
      count: 8
      cores_per_socket: 4
      hot_add_enabled: true
      hot_remove_enabled: true
    memory:
      hot_add_enabled: false
      size_MiB: "{{ memory }}"
    disks:
    - type: SATA
      new_vmdk:
        name: second_disk
        capacity: 214748364800
  register: _result
